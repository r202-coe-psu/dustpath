__BRYTHON__.use_VFS = true;
var scripts = {"$timestamp": 1639944544247, "processors": [".py", "from . import status\n\n__all__=[\"status\"]\n", ["processors", "processors.status"], 1], "processors.status": [".py", "from browser import ajax,document,window,timer,html,bind\nimport javascript\n\n\nclass ProcessorStatus:\n def __init__(self,icon_size=\"large\",type=\"circle\"):\n  self.icon_size=icon_size\n  \n  self.type=type\n  \n def disable_button(self,docs,cam_id):\n  for doc in docs:\n   if doc.id ==cam_id:\n   \n    if \"loading\"in doc.className:\n     doc.className=doc.className.replace(\"loading\",\"\")\n    doc.disabled=True\n    \n def enable_button(self,docs,cam_id):\n  for doc in docs:\n   if doc.id ==cam_id:\n    if \"loading\"in doc.className:\n     doc.className=doc.className.replace(\"loading\",\"\")\n    doc.disabled=False\n    \n @bind(\"button.start-recorder\",\"click\")\n def start_lpr(ev):\n  print(ev.target.className)\n  target_id=ev.target.id\n  if ev.target.tagName ==\"I\":\n   target_id=ev.target.parent.id\n   ev.target.parent.className=\"ui loading icon button start-recorder\"\n  else :\n   ev.target.className=\"ui loading icon button start-recorder\"\n  camera_id,project_id=target_id.split(\"/\")\n  \n  ajax.post(\n  f\"/cameras/{camera_id}/start-recorder\",data={\"project_id\":project_id}\n  )\n  \n def update_state(self,req_data):\n  for data in req_data:\n   print(data)\n   \n   \n   data_id=data[\"camera_id\"]+\"/\"+data[\"project_id\"]\n   \n   i=html.I()\n   color=\"grey\"\n   \n   if data[\"state\"]in [\"running\",\"start\"]:\n    color=\"green\"\n    s=html.SPAN(style={\"color\":\"green\"})\n    if \"video-recorder\"in data[\"type\"]:\n     self.disable_button(document.select(\".start-recorder\"),data_id)\n     self.enable_button(document.select(\".stop-recorder\"),data_id)\n    else :\n     self.disable_button(document.select(\".stop-recorder\"),data_id)\n     self.enable_button(document.select(\".start-recorder\"),data_id)\n   elif data[\"state\"]in [\"starting\"]:\n    color=\"yellow\"\n    s=html.SPAN(style={\"color\":\"yellow\"})\n    if \"video-recorder\"in data[\"type\"]:\n     self.enable_button(document.select(\".stop-recorder\"),data_id)\n     self.enable_button(document.select(\".start-recorder\"),data_id)\n   elif data[\"state\"]in [\"stop\"]:\n    color=\"grey\"\n    s=html.SPAN(style={\"color\":\"grey\"})\n    \n    \n    \n    \n    self.disable_button(document.select(\".stop-recorder\"),data_id)\n    self.enable_button(document.select(\".start-recorder\"),data_id)\n   elif data[\"state\"]in [\"stopping\"]:\n    color=\"red\"\n    s=html.SPAN(style={\"color\":\"red\"})\n    \n    self.enable_button(document.select(\".stop-recorder\"),data_id)\n    self.enable_button(document.select(\".start-recorder\"),data_id)\n    \n   i.class_name=f\"ui {color} circle icon {self.icon_size}\"\n   label=html.DIV(\n   data[\"state\"].capitalize(),Class=f\"ui {color} large label\",styles={}\n   )\n   label.style={\"width\":\"6rem\",\"text-align\":\"center\"}\n   try :\n    document[f\"state-{data['camera_id']}\"].text=\"\"\n    document[f\"state-{data['camera_id']}\"].clear()\n    streamer_icon=html.I()\n    streamer_icon.class_name=\"inverted grey chromecast icon big\"\n    recorder_icon=html.I()\n    recorder_icon.class_name=\"inverted grey record vinyl icon big\"\n    acquisitor_icon=html.I()\n    acquisitor_icon.class_name=\"inverted grey video icon big\"\n    if self.type ==\"text\":\n     document[f\"state-{data['camera_id']}\"]<=label\n     if \"video-streamer\"in data[\"type\"]:\n      streamer_icon.class_name=\"inverted green chromecast icon big\"\n     if \"video-recorder\"in data[\"type\"]:\n      recorder_icon.class_name=(\n      \"inverted green record vinyl icon big\"\n      )\n     if \"acquisitor\"in data[\"type\"]:\n      acquisitor_icon.class_name=\"inverted green video icon big\"\n      \n      \n      \n     document[f\"state-{data['camera_id']}\"]<=recorder_icon\n     document[f\"state-{data['camera_id']}\"]<=streamer_icon\n     document[f\"state-{data['camera_id']}\"]<=acquisitor_icon\n     \n    elif self.type ==\"circle\":\n     document[f\"state-{data['camera_id']}\"]<=i+s\n   except Exception:\n    continue\n    \n def on_ajax_complete(self,request):\n  request_data=javascript.JSON.parse(request.text)\n  \n  self.update_state(request_data)\n  \n def get_all_camera_state(self):\n  ajax.get(\n  f\"{self.get_state_url}\",\n  oncomplete=self.on_ajax_complete,\n  )\n  \n @bind(\"a.run-wrf\",\"click\")\n def run_wrf(ev):\n  target_id=ev.target.id\n  project_id=target_id.split(\"-\")[1]\n  ajax.post(\n  f\"/projects/{project_id}/run_wrf\",data={\"project_id\":project_id}\n  )\n  \n  \n  \n  \n  \n", ["browser", "javascript"]]}
__BRYTHON__.update_VFS(scripts)
